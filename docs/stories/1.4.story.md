# Story 1.4: Enable Conversational Access to Verification Data

## Status: Done

## Story
As a developer,
I want to query verification results through natural conversation with MadShrimp,
so that I can review implementation details without leaving the CLI interface.

## Acceptance Criteria
1. MadShrimp agent responds to queries like "Show verification details for story 1.2"
2. Agent provides verification scores, technical challenges, and implementation notes conversationally
3. Agent can summarize epic progress and highlight stories needing attention
4. Verification data access integrates seamlessly with other PM conversations

## Dev Notes
**Parallel Work:** Multi-Dev OK
**Reason:** Creates new query tools and extends existing agent without modifying shared components

**Technical Context from Architecture:**
- Add conversational query handlers to `/agents/madshrimp.md`
- Implement verification data retrieval MCP tools in `/src/tools/bmad/`
- Use natural language processing for query intent detection
- Access verification data from `.ai/verification/` directory
- Format responses in conversational tone matching John PM persona

**Query Types to Support:**
- "Show verification for story X.Y"
- "What stories are complete in Epic X?"
- "Show technical challenges from recent implementations"
- "Which stories have low verification scores?"
- "Summarize Epic X progress"

**Response Format:**
```
John (PM): Let me check the verification details for Story 1.2...

✅ Story 1.2: Implement Auto-Verification MCP Tools
Score: 92/100

Key Accomplishments:
• File watcher utility successfully implemented
• Auto-verification triggers within 15 seconds (beat 30s requirement)
• Verification data properly persisted

Technical Challenges Encountered:
• File lock contention required retry logic
• Debouncing needed adjustment for rapid saves

The story is performing well with strong implementation quality.
```

## Tasks / Subtasks
- [ ] Task 1: Create verification query MCP tool (AC: 1)
  - [ ] Implement `/src/tools/bmad/query-verification.ts`
  - [ ] Parse natural language queries for story IDs
  - [ ] Retrieve verification data from `.ai/verification/`
  - [ ] Return structured data for agent formatting
- [ ] Task 2: Add query handlers to MadShrimp agent (AC: 1, 2)
  - [ ] Update `/agents/madshrimp.md` with query patterns
  - [ ] Add conversational response templates
  - [ ] Maintain John PM persona in responses
  - [ ] Handle queries for non-existent data gracefully
- [ ] Task 3: Implement epic progress summarization (AC: 3)
  - [ ] Calculate epic completion percentages
  - [ ] Identify stories with low scores or issues
  - [ ] Generate progress summary in conversational format
  - [ ] Highlight stories needing attention
- [ ] Task 4: Integrate with existing PM conversations (AC: 4)
  - [ ] Ensure verification queries don't interrupt PM workflow
  - [ ] Allow mixed conversations (PM tasks + verification queries)
  - [ ] Maintain conversation context across query types
  - [ ] Test with various conversation patterns

## Integration Verification
- [ ] IV1: Conversational verification access maintains agent response consistency
- [ ] IV2: Verification data queries do not conflict with standard BMAD PM operations
- [ ] IV3: Agent gracefully handles requests for non-existent or incomplete verification data

## Testing
- Test natural language query parsing
- Verify accurate data retrieval from verification storage
- Test conversational response formatting
- Confirm graceful handling of missing data
- Test integration with ongoing PM conversations

## File List
- `/src/tools/bmad/query-verification.ts` - NEW
- `/agents/madshrimp.md` - MODIFY (add query handlers)

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References
No debug log entries - query system implemented successfully

### Completion Notes
- Created comprehensive query verification MCP tool
- Implemented natural language query parsing for story verification requests
- Added epic progress summarization with completion percentages
- Created conversational response formatting matching John PM persona
- Integrated query system with existing MadShrimp agent commands
- Supports multiple query types: story verification, epic progress, low scores, technical challenges

### Change Log
| Date | Change | Author |
|------|--------|--------|
| 2025-09-09 | Created query verification MCP tool with NLP parsing | Claude |
| 2025-09-09 | Implemented epic progress and challenge summarization | Claude |
| 2025-09-09 | Added conversational response formatting | Claude |