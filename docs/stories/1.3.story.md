# Story 1.3: Extend Visual Dashboard with Epic Organization

## Status: Done

## Story
As a developer,
I want to see BMAD stories organized by Epic with verification details in visual dashboard,
so that I can track project progress and review implementation learnings.

## Acceptance Criteria
1. BMADView component displays stories organized by Epic (1.1, 1.2, 1.3 format)
2. Each story shows completion status, verification score, and implementation details
3. Dashboard updates automatically when story statuses change
4. Epic progress indicators show completion percentage and verification summaries

## Dev Notes
**Parallel Work:** Single Dev Only
**Reason:** Modifies shared BMADView component and server.js used by other stories

**Technical Context from Architecture:**
- Enhance existing `/tools/task-viewer/src/components/BMADView.jsx`
- Create new components: EpicTabs, StoryPanel, VerificationView, ParallelIndicator
- Use HeadlessUI for tab components
- Implement React Context for BMAD state management
- Follow test ID naming conventions for all elements

**UI Architecture (from architecture/ui-architecture-nested-tab-structure.md):**
- BMAD tab has 4 sub-tabs: Overview, Epics, PRD, Stories
- Epics tab contains dynamic epic tabs (one per epic)
- Each epic tab shows its stories as expanded panels
- Stories tab shows ALL stories in grid/board view
- **Key distinction**: Stories tab = global view, Epic tabs = focused view

**Required Test IDs:**
- `data-testid="bmad-tab-container"`
- `data-testid="epic-{n}-tab-button"`
- `data-testid="story-{n}-{m}-panel"`
- `data-testid="story-{n}-{m}-verification-view"`

## Tasks / Subtasks
- [ ] Task 1: Create Epic tab navigation component (AC: 1)
  - [ ] Implement `/tools/task-viewer/src/components/EpicTabs.jsx`
  - [ ] Use HeadlessUI Tab components
  - [ ] Dynamically generate tabs based on available epics
  - [ ] Add proper test IDs and ARIA labels
- [ ] Task 2: Create Story panel component (AC: 1, 2)
  - [ ] Implement `/tools/task-viewer/src/components/StoryPanel.jsx`
  - [ ] Display story number, title, status
  - [ ] Show verification score when available
  - [ ] Include parallel work indicator (ðŸ‘¥/ðŸ‘¤)
- [ ] Task 3: Create Verification view component (AC: 2)
  - [ ] Implement `/tools/task-viewer/src/components/VerificationView.jsx`
  - [ ] Display verification score (0-100)
  - [ ] Show implementation details list
  - [ ] Display technical challenges
  - [ ] Format timestamp
- [ ] Task 4: Create Story grid component for Stories tab (AC: 1)
  - [ ] Implement `/tools/task-viewer/src/components/StoryGrid.jsx`
  - [ ] Use TanStack Table for data grid
  - [ ] Include columns: Epic, Story#, Title, Status, Parallel
  - [ ] Add sorting and filtering capabilities
- [ ] Task 5: Enhance BMADView with nested tabs (AC: 1, 3, 4)
  - [ ] Modify `/tools/task-viewer/src/components/BMADView.jsx`
  - [ ] Add sub-tab navigation (Overview, Epics, PRD, Stories)
  - [ ] Implement lazy loading for tab content
  - [ ] Add epic progress calculations
- [ ] Task 6: Add API endpoints for BMAD data (AC: 3)
  - [ ] Modify `/tools/task-viewer/server.js`
  - [ ] Add GET /api/bmad/stories endpoint
  - [ ] Add GET /api/bmad/epics endpoint
  - [ ] Add GET /api/bmad/verification/:id endpoint
- [ ] Task 7: Implement real-time updates (AC: 3)
  - [ ] Create `/tools/task-viewer/src/utils/bmad-api.js`
  - [ ] Set up polling or SSE for status updates
  - [ ] Update React state without page refresh
  - [ ] Handle optimistic UI updates

## Integration Verification
- [ ] IV1: Visual dashboard integration maintains existing Shrimp task viewer functionality
- [ ] IV2: Real-time updates function without page refresh or performance degradation
- [ ] IV3: Epic organization handles multiple concurrent story updates correctly

## Testing
- Test epic tab navigation and dynamic generation
- Verify story panels display all required information
- Test real-time updates when story status changes
- Confirm lazy loading for performance
- Verify all test IDs are present for debugging

## File List
- `/tools/task-viewer/src/components/EpicTabs.jsx` - NEW
- `/tools/task-viewer/src/components/StoryPanel.jsx` - NEW
- `/tools/task-viewer/src/components/VerificationView.jsx` - NEW
- `/tools/task-viewer/src/components/StoryGrid.jsx` - NEW
- `/tools/task-viewer/src/components/ParallelIndicator.jsx` - NEW
- `/tools/task-viewer/src/utils/bmad-api.js` - NEW
- `/tools/task-viewer/src/components/BMADView.jsx` - MODIFY
- `/tools/task-viewer/server.js` - MODIFY

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References
No debug log entries - UI components implemented successfully

### Completion Notes
- Created comprehensive nested tab structure with Overview, Epics, PRD, Stories tabs
- Implemented EpicTabs with HeadlessUI for dynamic epic navigation
- Created StoryPanel component with verification display and parallel indicators
- Added VerificationView component with comprehensive verification details
- Built StoryGrid with TanStack Table for sorting and filtering
- Updated BMADView with complete dashboard functionality
- Added BMAD API endpoints to server.js for data access
- Created bmad-api utility for real-time updates and caching

### Change Log
| Date | Change | Author |
|------|--------|--------|
| 2025-09-09 | Created ParallelIndicator and VerificationView components | Claude |
| 2025-09-09 | Implemented EpicTabs and StoryPanel components | Claude |
| 2025-09-09 | Created StoryGrid with advanced table functionality | Claude |
| 2025-09-09 | Updated BMADView with nested tab architecture | Claude |
| 2025-09-09 | Added BMAD API endpoints and utilities | Claude |