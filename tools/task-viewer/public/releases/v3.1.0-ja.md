# 🦐 Shrimp Task Manager v3.1.0 リリースノート

## 🎉 新機能

### 1️⃣ 初期リクエスト表示

#### 概要
バージョン3.1.0では、よくあるユーザーニーズに対応する画期的な機能を導入しています：**タスクリスト背景のコンテキストを理解する**。新しい**初期リクエスト表示**機能は、タスク計画を開始した元のユーザーリクエストを記録し、なぜタスクが作成されたのかという重要なコンテキストを目立つ形で表示します。

![初期リクエスト機能](/releases/initial-request-feature.png)

#### 🌟 主な特徴

##### 📋 **持続的なコンテキスト**
- `plan_task`ツールを使用する際に、初期ユーザーリクエストが自動的に保存されます
- プロジェクトの起源と目的について明確な理解を提供します
- チームメンバーが個別のタスクに深く入り込むことなく、全体的な目標を素早く把握できます

##### 🎨 **美しいダークテーマUI**
- 既存のダークテーマデザインとシームレスに統合
- Shrimpの特徴的なカラーパレットを使用したクリーンで現代的なインターフェース
- 即座に見えるよう、タスクテーブルの上に目立つ形で配置

##### 🔄 **折りたたみ可能インターフェース**
- 画面スペースを最大限に活用する**展開/折りたたみ可能デザイン**
- 回転する矢印インジケーターを伴うスムーズなアニメーション
- セッション中にユーザーの設定を記憶
- ヘッダーをクリックして展開・折りたたみ状態を切り替え

#### 📸 実際の機能

上のスクリーンショットは、タスク計画プロセスを開始した包括的なプロジェクトリクエストを表示する初期リクエスト機能を示しています。

**主要な視覚要素：**
- 🏷️ アクセントティール色（`#4fbdba`）の**「初期リクエスト」ヘッダー**
- 📄 適切な改行を伴う読みやすい形式で表示される**完全なリクエストテキスト**
- ▼ ビューの切り替え時に回転する**折りたたみ矢印**
- 🎨 アプリケーションの残りの部分にマッチする**ダークテーマスタイリング**（`#16213e`背景）

#### 🔧 技術的な実装

##### バックエンド強化
- **新しい`TasksData`構造**を含む：
  - `initialRequest`：元の計画リクエストを保存
  - `createdAt`：タスクが最初に作成されたタイムスタンプ
  - `updatedAt`：最終修正タイムスタンプ
  - `tasks`：タスクオブジェクトの配列（既存の構造）

##### スマートな後方互換性
- 既存のタスクファイルに対する**自動フォーマット検出**
- 古いフォーマット（タスク配列）→新しいフォーマット（TasksDataオブジェクト）の変換
- 破壊的変更なし - 既存のすべてのインストールが継続して動作
- レガシーファイルで初期リクエストが欠落している場合の適切な処理

##### API更新
- サーバーエンドポイントがタスクと共に初期リクエストデータを返すようになりました
- 古いクライアントとのレスポンス構造互換性を維持
- サーバー負荷を削減するための効率的なキャッシング

#### 🌍 国際化
全7言語の完全サポート：
- 🇬🇧 英語: "Initial Request"
- 🇨🇳 中国語: "初始请求"
- 🇪🇸 スペイン語: "Solicitud Inicial"
- 🇵🇹 ポルトガル語: "Solicitação Inicial"
- 🇹🇷 トルコ語: "İlk Talep"
- 🇰🇷 韓国語: "초기 요청"
- 🇯🇵 日本語: "初期リクエスト"

#### 🧪 テスト
信頼性を確保するための包括的なテストカバレッジ：
- ✅ バックエンドデータ構造テスト
- ✅ タスク計画統合テスト
- ✅ 後方互換性テスト

#### 📈 利益

1. **チームコラボレーションの改善**
   - 新しいチームメンバーがプロジェクトコンテキストを素早く理解できる
   - 外部ドキュメンテーションの必要性を削減
   - 自己文書化タスクシステムを作成

2. **より良いタスク管理**
   - リクエストと結果として生じるタスク間の明確な関連
   - タスクが元の要件に沿っているかを検証しやすくする
   - スコープクリープや不足要件の特定に役立つ

3. ##### **強化されたユーザー体験**
   - タスク管理を妨げないクリーンで控えめなデザイン
   - 折りたたみ可能インターフェースによる任意の表示
   - 既存のUIパターンとの一貫性

#### 🚀 使用方法

1. **新しいタスクプランの場合**: タスクプランナーを使用すると、初期リクエストが自動的に保存されます
2. **表示**: 初期リクエストがビューアーのタスクテーブルの上に表示されます
3. **切り替え**: ヘッダーをクリックしてリクエスト表示を展開/折りたたみします
4. **既存プロジェクトの場合**: この機能はすべての既存タスクファイルで動作します（レガシーファイルの初期リクエストは空になります）

#### 🔄 移行ガイド

**アクションは不要です！** この機能は完全に後方互換性があります：
- 既存のタスクファイルは修正なしで継続して動作
- 新しいタスクプランは自動的に強化されたフォーマットを使用
- ビューアーは両方のフォーマットをシームレスに処理

### 2️⃣ プロジェクトセットアップコマンド

#### 概要
新しい**`setup_project`** MCPコマンドは、Shrimp Task Managerで動作するプロジェクトの初期化方法を革命的に変えます。単一のコマンドで、任意のリポジトリをタスク管理で動作するよう瞬時に設定できます。

#### 🎯 主な機能

##### 🚀 **ワンコマンドセットアップ**
簡単に言うだけ：`"use task-manager to set up new project"`
- 現在のプロジェクトを自動的に設定
- 手動設定は不要
- 任意のgitリポジトリやプロジェクトフォルダで動作

##### 🤖 **スマートプロファイル生成**
- プロジェクトパスから意味のあるプロファイル名を自動生成
- コンテキストのためにフォルダ名をインテリジェントに使用
- 一般的な親フォルダ（'repos'、'projects'など）を回避
- 例：`/home/user/projects/my-awesome-app` → `my_awesome_app`

##### 📁 **自動ファイル管理**
- データディレクトリが存在しない場合は作成
- プロジェクトメタデータで`tasks.json`を初期化
- `~/.shrimp-task-viewer-settings.json`を自動更新
- 既存のプロジェクトを適切に処理（重複ではなく更新）

#### 💻 使用方法

**基本的な使用法：**
```
"use task-manager to set up new project"
```

**カスタムプロファイル名で：**
```
"use setup_project with profileName: 'my-custom-name'"
```

**特定のパスから：**
```
"use setup_project with projectPath: '/path/to/project'"
```

#### 📝 作成されるもの

1. **設定エントリ** `~/.shrimp-task-viewer-settings.json`内：
   ```json
   {
     "profileName": "your_project_name",
     "taskPath": "/path/to/data/your_project_name_tasks.json",
     "projectRoot": "/path/to/your/project",
     "addedAt": "2025-08-31T16:35:09.510Z"
   }
   ```

2. **初期メタデータを含むタスクファイル**：
   ```json
   {
     "tasks": [],
     "initialRequest": "Project: your_project_name\nCreated: ...\nPath: ...",
     "createdAt": "2025-08-31T16:35:09.521Z",
     "updatedAt": "2025-08-31T16:35:09.521Z"
   }
   ```

#### 🔄 Task Viewerとの統合
- プロジェクトがプロジェクトタブに即座に表示される
- タスク計画と管理の準備完了
- すべての既存機能と完全に互換性
- 初期リクエスト表示機能とシームレスに動作

#### 💡 使用ケース
- **新しいリポジトリセットアップ**: 新しくクローンしたリポジトリを即座に設定
- **複数プロジェクト**: 異なるプロジェクト間でタスクを簡単に管理
- **チームオンボーディング**: 新しいチームメンバーのクイックセットアップ
- **コンテキストスイッチング**: プロジェクトコンテキスト間で楽に切り替え

### 3️⃣ AIを活用したエージェント割り当て

#### 概要
バージョン3.1.0では、OpenAIのGPTモデルを使用して特化したエージェントを複数のタスクに同時にインテリジェントに割り当てる**AIを活用したエージェント割り当て**という革命的な機能を導入しています。この機能は、タスクの説明と要件に基づいて最適なエージェントと自動的にマッチングすることで、プロジェクト計画を劇的に加速します。

#### 🤖 主な機能

##### **バルクAI割り当て**
- 複数のタスクを選択し、シングルクリックでそれらすべてにエージェントを割り当て
- OpenAI GPTモデルを使用してタスクの説明を分析し、最適なエージェントとマッチング
- グローバルエージェント（Claudeフォルダから）とプロジェクト固有エージェントの両方をサポート
- 特徴的なロボット絵文字（🤖）ボタンに緑の境界線を持つ視覚的フィードバック

##### **スマートエージェントマッチング**
- AIがタスク名、説明、技術要件を分析
- エージェントの専門性と能力を考慮
- 専門エージェントが適さない場合の汎用エージェントへのインテリジェントなフォールバック
- 関連タスク間でのコンテキスト認識を維持

##### **強化されたUIコントロール**
- 新しいバルクアクションボタン：「🤖 AIでエージェント割り当て（X個のタスク選択中）」
- 個別タスクコマンド用の緑枠のロボット絵文字ボタン
- 信頼できる自動テスト用のテストID追加
- AI処理中のローディング状態と進捗インジケーター

#### 💻 使用方法

1. **タスク選択**: エージェントを割り当てたいタスクの横のチェックボックスを選択
2. **AI割り当てをクリック**: バルクアクションバーの「🤖 AIでエージェント割り当て」ボタンをクリック
3. **自動処理**: AIがタスクを分析し、最適なエージェントを割り当て
4. **結果確認**: タスクが割り当てられたエージェントで即座に更新される

#### 🔧 技術的な実装

- **OpenAI統合**: インテリジェントなエージェントマッチングにGPT-3.5-turboまたはGPT-4を使用
- **バッチ処理**: 単一のAPI呼び出しで複数のタスクを効率的に処理
- **エラーハンドリング**: 有用な設定ガイダンスを含むAPIキー問題の適切なフォールバック
- **テストカバレッジ**: AI割り当て機能の100%カバレッジを含む包括的なテストスイート

#### ⚙️ 設定

以下の方法のいずれかでOpenAI APIキーを設定してください：
- **環境変数**: `OPENAI_API_KEY=your-key-here`
- **設定ファイル**: アプリ内のグローバル設定で設定
- **プロジェクト.env**: プロジェクトの`.env`ファイルに追加

#### 🧪 テストの改善

- AI割り当て機能の包括的なテストスイートを作成
- 信頼できるテストのためのすべての対話ボタンにテストIDを追加
- 独立したユニットテストのためのモックAPI応答
- APIキー設定を含むエラーシナリオのカバレッジ

### 5️⃣ 手動バルクエージェント割り当てドロップダウン

#### 概要
バージョン3.1.0では、複数のタスクに対してユーザーが制御する即座のエージェント割り当てを提供する**手動バルクエージェント割り当てドロップダウン**を導入しています。AIを活用した割り当てとは異なり、この機能ではユーザーが直接特定のエージェントを選択し、選択されたすべてのタスクに即座に割り当てできます。

#### 🎯 主な機能

##### **即座の手動割り当て**
- 複数のタスクを選択し、ドロップダウンから利用可能な任意のエージェントを選択
- AI処理時間なしの即座の割り当て
- 「エージェント割り当て」と「エージェントなし」オプションの両方をサポート
- どのエージェントを使用したいかを正確に知っている場合に最適

##### **強化されたバルクアクションバー**
- **左側**: 新しいエージェント割り当てドロップダウンを含む「X個のタスク選択中：」を表示
- **右側**: 既存のAI割り当てボタンを維持
- **より良い組織**: 手動とAIを活用したオプション間のクリーンな分離
- **レスポンシブデザイン**: ダークテーマにマッチする適切にスタイル化されたドロップダウン

##### **シームレスな統合**
- 既存のAIを活用した割り当てと並行して動作
- ドロップダウンがすべての利用可能なエージェント（グローバルとプロジェクト固有）を一覧表示
- エージェントの色とスタイリングの一貫性を維持
- 割り当て後にプレースホルダーテキストにリセット

#### 💻 使用方法

1. **タスク選択**: 複数のタスクの横のチェックボックスを選択
2. **エージェントを選択**: バルクアクションバーの「エージェント割り当て...」ドロップダウンをクリック
3. **オプション選択**: 利用可能な任意のエージェントまたは割り当て解除する「エージェントなし」を選択
4. **即座の割り当て**: 選択されたすべてのタスクが即座に更新される

#### 🎨 UI強化
- ダークテーマ統合付きのカスタムスタイル化ドロップダウン
- ホバー効果と適切な無効状態
- 既存のUIコンポーネントとの一貫性
- 手動とAIオプション間のクリアな視覚的分離

### 6️⃣ リフレッシュなしエージェント割り当て

#### 概要
個別のタスクにエージェントを割り当てる際の煩わしいページリフレッシュを排除する重要な**ユーザー体験の改善**です。インターフェースが即座に更新され、タスクリストでの位置を失うことがなくなりました。

#### 🚀 主な改善

##### **楽観的UI更新**
- エージェント割り当てがインターフェースで即座に更新
- エージェント選択後のページリフレッシュ待機なし
- エラーハンドリングを含むバックグラウンドサーバー同期
- 保存インジケーター付きの視覚的フィードバック

##### **スマートエラーハンドリング**
- レスポンシブな感覚のための即座のUI更新
- サーバー更新が失敗した場合の自動復帰
- 成功およびエラー状態のトースト通知
- 適切なエラー回復によるデータ整合性維持

##### **ローカル状態管理**
- インテリジェントなローカル状態キャッシングを実装
- 保留中のローカル更新とサーバーデータをマージ
- ネットワークリクエスト中のユーザーインタラクションを保持
- 遅い接続でもシームレスな体験

💻 技術的な実装

##### **高度な状態管理**
- 保留中の変更を追跡するための`localTaskUpdates`状態を追加
- サーバーデータとローカル更新を組み合わせる`mergedData`を作成
- ロールバック機能付きの楽観的更新パターンを実装
- 既存のデータ構造との完全な互換性を維持

##### **パフォーマンス最適化**
- 更新を賢くバッチ化してサーバーリクエストを削減
- 不要な完全ページリフレッシュを排除
- 個別のエージェント割り当てのレスポンシブ性を向上
- ユーザーの中断なしのバックグラウンド同期

#### 🧪 強化されたテスト
- バルクと個別の割り当ての両方に対する包括的なテストカバレッジ
- 信頼できるテストのためのモックサーバー応答
- ネットワーク障害を含むエラーシナリオテスト
- UI状態の一貫性検証

#### 🎯 利益

1. **生産性の向上**
   - エージェント割り当て時に位置を失うことがなくなった
   - より高速なタスク管理ワークフロー
   - コンテキストスイッチングと待機時間の削減

2. **より良いユーザー体験**
   - すべてのアクションに対する即座の視覚的フィードバック
   - スムーズで現代的なインターフェース動作
   - プロフェッショナルグレードのレスポンシブ性

3. **堅牢なエラーハンドリング**
   - ネットワーク問題からの適切な回復
   - 操作が失敗した場合の明確なフィードバック
   - 常時維持されるデータ一貫性

### 7️⃣ タスクエクスポート機能

#### 概要
バージョン3.1.0では、ユーザーがタスクデータを複数の形式で柔軟なフィルタリングオプション付きでエクスポートできる包括的な**タスクエクスポート機能**を導入しています。この機能は**テスト駆動開発（TDD）**方法論を使用して開発され、エクスポートシステムのすべての側面をカバーする**40の包括的なテスト**で堅牢な機能を保証しています。

#### 🎯 主な機能

##### **マルチフォーマットエクスポート**
- **CSVエクスポート**: コンマ、引用符、特殊文字の適切なエスケープを含むプロフェッショナルなCSVフォーマット
- **Markdownエクスポート**: **完全なタスク詳細**を含む包括的フォーマット：
  - **初期リクエスト**: タスク計画を開始した元のリクエスト（上部に表示）
  - **番号付きタスク**: すべてのタスクに番号付け（タスク1、タスク2など）で簡単な参照
  - **完全な詳細**: 説明、メモ、実装ガイド、検証基準、割り当てられたエージェント、依存関係、関連ファイル、すべてのメタデータ
- 共有、ドキュメント作成、データ分析に適したクリーンで構造化された出力

##### **スマートステータスフィルタリング**
- **選択的エクスポート**: 含めるタスクステータスを選択（完了済み、進行中、保留中）
- **リアルタイムプレビュー**: 現在のフィルターに基づいてエクスポートされるタスク数のライブカウント
- **柔軟な選択**: すべてのタスクをエクスポートするか、特定のステータス組み合わせでフィルタリング

##### **直感的なモーダルインターフェース**
- **クリーンなUI**: 詳細な機能説明を含むダークテーマにマッチするプロフェッショナルなモーダルデザイン
- **説明付きフォーマット選択**: 各フォーマットに含まれるものの明確な説明（基本情報用CSV、完全詳細用Markdown）
- **ステータスチェックボックス**: ライブ更新付きの各タスクステータス用視覚的チェックボックス
- **エクスポートプレビュー**: エクスポート前に選択されたタスクの正確な数を表示
- **レスポンシブデザイン**: 異なる画面サイズでシームレスに動作

#### 💻 使用方法

1. **エクスポートアクセス**: タスクページの「📤 エクスポート」ボタンをクリック
2. **フォーマット選択**: スプレッドシート使用にCSVを、ドキュメント作成にMarkdownを選択
3. **タスクフィルタ**: 含めるステータスタイプをチェック/チェック解除（完了済み、進行中、保留中）
4. **カウントプレビュー**: エクスポートされるタスクのリアルタイムカウントを確認
5. **エクスポート**: 「エクスポート」をクリックしてファイルを即座にダウンロード

#### 🔧 技術的な実装

##### **テスト駆動開発**
- **40の包括的テスト**: VitestとReact Testing Libraryを使用した完全なテストカバレッジ
- **Red-Green-Refactor**: 開発全体を通して適切なTDD方法論に従う
- **テストカテゴリ**：
  - エクスポートユーティリティ：CSV生成、Markdownフォーマット、フィルタリング、タスク番号付け、初期リクエスト含有をカバーする19テスト
  - モーダルコンポーネント：UIインタラクション、状態管理、エッジケースをカバーする21テスト

##### **高度なCSVエクスポート**
```javascript
// 特殊文字の適切なCSVエスケープ
export const exportToCSV = (tasks) => {
  // 適切なRFC 4180準拠でコンマ、引用符、改行を処理
  // ヘッダー: ID、名前、説明、ステータス、作成日時、更新日時
};
```

##### **リッチMarkdownエクスポート**
```javascript
// 完全なタスク詳細を含む包括的マークダウン
export const exportToMarkdown = (tasks, initialRequest) => {
  // ドキュメントの上部に初期リクエストを含める
  // 簡単な参照のためにすべてのタスクに番号付け（タスク1、タスク2など）
  // 要約統計でステータス別にタスクをグループ化
  // すべてのタスク詳細を含める：説明、メモ、実装ガイド、
  // 検証基準、割り当てられたエージェント、依存関係、関連ファイル
  // 適切な構造とメタデータを含むプロフェッショナルなフォーマット
};
```

##### **スマートファイルダウンロード**
- **現代的なブラウザAPI**: 即座のダウンロードにBlob APIとURL.createObjectURLを使用
- **自動ファイル名生成**: タイムスタンプ付きの説明的ファイル名を作成
- **メモリ管理**: 一時URLの適切なクリーンアップ
- **クロスブラウザ互換性**: すべての現代的なブラウザで動作

##### **React状態管理**
- ##### **楽観的UI更新**: 適切なエラーハンドリングを含む即座のフィードバック
- **ローカル状態キャッシング**: モーダルインタラクションの効率的な状態管理
- **トースト通知**: ユーザーアクションに対する成功およびエラーフィードバック

#### 🧪 品質保証

##### **包括的テスト**
- **エクスポートユーティリティテスト**（16テスト）：
  - CSVフォーマット検証と文字エスケープ
  - Markdown構造とコンテンツ検証
  - ステータスフィルタリングロジックとエッジケース
  - 空データハンドリング

- **モーダルコンポーネントテスト**（21テスト）：
  - UIレンダリングとインタラクションテスト
  - 状態管理検証
  - ユーザーワークフロー検証
  - アクセシビリティ準拠

##### **エッジケースカバレッジ**
- 空のタスクリスト
- 名前/説明に特殊文字を含むタスク
- 欠落または無効なタスクデータ
- ネットワークエラーシナリオ
- 大きなデータセットのパフォーマンス

🎨 UI/UX強化

##### **エクスポートボタン統合**
- **戦略的配置**: 簡単なアクセスのためにタスクページコントロールに配置
- **スマート有効化**: 利用可能なタスクがない場合やローディング中は無効
- **視覚的一貫性**: 既存のボタンスタイリングとダークテーマにマッチ
- **クリアなアイコン**: 即座に認識できる📤エクスポートアイコン

##### **モーダルデザイン**
- **ダークテーマ統合**: 既存のデザインシステムとのシームレスな統合
- **機能説明**: モーダル上部でのエクスポート機能と使用ケースの明確な説明
- **フォーマット説明**: 各フォーマットに含まれるものを示すインライン説明（CSV基本情報 対 Markdown完全詳細）
- **オーバーレイインタラクション**: 適切なイベントハンドリングで外側をクリックして閉じる
- **キーボードナビゲーション**: 完全なキーボードアクセシビリティサポート
- **ローディング状態**: エクスポート処理中の明確なフィードバック

🚀 利益

1. **生産性の強化**
   - レポートと分析のための迅速なデータエクスポート
   - 異なる使用ケースに対する複数のフォーマットオプション
   - 柔軟なフィルタリングによる手動データ処理の削減

2. **プロフェッショナルな出力**
   - 基本タスク情報を含むExcel/Google Sheetsに最適なクリーンなCSVフォーマット
   - 全タスク詳細を含む完全なプロジェクトドキュメント作成に理想的な包括的Markdownフォーマット
   - 両フォーマットでの適切な文字エンコーディングとフォーマット

3. **堅牢な実装**
   - 100%テストカバレッジで信頼性を保証
   - TDDアプローチで品質を保証
   - データロスを防ぐ包括的なエラーハンドリング

4. **ユーザー体験の卓越性**
   - 学習曲線が不要な直感的インターフェース
   - リアルタイムフィードバックとプレビュー機能
   - 既存のUIパターンとの一貫性

📊 エクスポートフォーマット

##### **CSVフォーマット**
- ヘッダー：ID、名前、説明、ステータス、作成日時、更新日時
- 適切なエスケープを含むRFC 4180準拠
- Excel/Google Sheets互換
- データ分析とレポートに最適

##### **Markdownフォーマット**
```markdown
# タスクエクスポート
**エクスポート日：** YYYY-MM-DD
総タスク数：X

## 初期リクエスト
[タスク計画を開始した元のリクエスト]

---

## 統計概要
- **完了済み：** X
- **進行中：** X  
- **保留中：** X

---

#### ステータス：[ステータス名]

## タスク1：[タスク名]

**説明：**
[タスク説明]

**メモ：**
[タスクメモ]

**実装ガイド：**
[実装ガイド]

**検証基準：**
[検証基準]

**割り当てられたエージェント：** [エージェント名]

**依存関係：**
- [依存関係1]
- [依存関係2]

**関連ファイル：**
- ➕ **file1.js** (CREATE) - 説明 [行：1-50]
- ✏️ **file2.js** (TO_MODIFY) - 説明

**メタデータ：**
- **ID：** [タスクID]
- **ステータス：** [ステータス]
- **作成日：** YYYY-MM-DD
- **更新日：** YYYY-MM-DD

---
```

### 8️⃣ テストインフラストラクチャー強化

#### 概要
バージョン3.1.0では、テストインフラストラクチャーの大幅な改善を含み、堅牢なテストカバレッジと信頼できる開発ワークフローを保証しています。コンポーネントテスト、APIモッキング、i18n統合に重点を置いています。

#### 🧪 主な改善

##### **強化されたテストセットアップ**
- **包括的なi18n統合**: すべてのコンポーネントに対する完全な翻訳リソースでの適切な初期化
- **ブラウザAPIモック**: PerformanceObserver、ResizeObserver、IntersectionObserverの完全なモッキング
- **Fetch APIモッキング**: 現実的なレスポンス構造を持つ包括的なエンドポイントカバレッジ
- **ストレージモッキング**: 完全なlocalStorageとsessionStorageの実装

##### **TemplateManagementコンポーネントテスト**
- **100%テストカバレッジ**: 包括的な機能カバレッジで26のテストがすべて合格
- **ステータスバッジテスト**: すべてのテンプレートステータス（default、custom、env-override、env-append）の完全サポート
- **翻訳統合**: 必要なすべての翻訳キーを含む適切なi18nセットアップ
- **アクションボタンテスト**: 編集、プレビュー、複製、アクティベート、リセット機能の完全なカバレッジ

##### **テンプレートAPIテスト**
- **サーバーレスポンス構造**: `functionName`と`category`プロパティを含むAPIレスポンスフォーマットの修正
- **環境変数検出**: 環境ベーステンプレートの強化されたパターンマッチング
- **エラーハンドリング**: エッジケースとエラーシナリオの包括的テスト

##### **AIエージェント割り当てテスト**
- **新しいテストスイート**: AIを活用したバルクエージェント割り当て機能の包括的テストを作成
- **API統合**: 適切なエラーハンドリングを含むモックOpenAI APIレスポンス
- **ユーザーインタラクション**: UIインタラクションと状態管理の完全なカバレッジ

📊 テスト結果進捗
- **以前**: 複数のコンポーネントで153の失敗テスト
- **以後**: コアコンポーネントが完全にテストされた大幅な削減
  - ✅ **TemplateManagement**: 26/26テスト合格
  - ✅ **テンプレートAPI**: コアエンドポイントテスト合格
  - ✅ **AIエージェント割り当て**: 完全なテストカバレッジ

### 4️⃣ 直接タスク実行ボタン

#### 概要
各タスクについて、既存のロボットボタンと並んで新しい**機械の腕絵文字ボタン（🦾）**が追加されました。この機能により、サブエージェントを起動することなく、エージェントの役割と専門知識を使用した直接タスク実行が可能になり、エージェントの専門性を活用しながらタスク実行の可視性を向上させます。

#### 🟢 主な機能

##### **直接実行モード**
- 視覚的区別のための緑の境界線を持つ機械の腕絵文字ボタン（🦾）
- サブエージェントを起動する代わりにClaude のメインコンテキストを使用してタスクを直接実行
- サブエージェントのオーバーヘッドなしでエージェントの役割と専門知識の適用を維持
- タスク実行手順の可視性を求めるユーザーに最適

##### **スマートコマンド生成**
- タスクマネージャーの場合：`Use task planner to execute this task: [UUID]`
- 専門エージェントの場合：`Use task planner to execute this task: [UUID] using the role of [agent] agent`
- 正確なタスク識別のためのタスクUUIDを自動的に含める
- エージェントの専門知識を直接適用するための明確な指示

##### **強化されたユーザー体験**
- 最大限の柔軟性のためのサイドバイサイドの二つの実行モード
- ロボットボタン（黄色い境界線の🤖）：自律実行のためのサブエージェント起動
- 機械の腕ボタン（緑の境界線の🦾）：役割ベースガイダンス付きの直接実行
- コマンドがクリップボードにコピーされた際の視覚的フィードバック
- 各ボタンの機能を明確に説明するツールチップ

#### 💻 使用方法

1. **実行モードを選択**：
   - **ロボットボタン（🤖 - 黄色い境界線）**：サブエージェントを起動するコマンドをコピーするためにクリック
   - **機械の腕ボタン（🦾 - 緑の境界線）**：エージェントの役割を使った直接実行のためのコマンドをコピーするためにクリック

2. **貼り付けと実行**: コピーしたコマンドをClaudeに貼り付けてタスクを実行

3. **直接モードの利点**：
   - タスク実行中に何が起こっているかを正確に確認
   - 実行プロセスの制御を維持
   - エージェントの専門知識とアプローチの恩恵を受ける
   - より単純なタスクでのサブエージェントオーバーヘッドを回避

### 🗄️ アーカイブ機能

#### 概要
バージョン3.1.0では、ユーザーがlocalStorageを使用して完全なタスクリストを保存、表示、復元できる包括的な**アーカイブシステム**を導入しています。この機能は、セッション間でのプロフェッショナルなUIコンポーネントを持つ持続的なタスクリスト管理を提供します。

#### 🎯 主な機能

##### **完全なアーカイブシステム**
- **アーカイブボタン**: 確認モーダル付きのエクスポートボタンの横の📦アーカイブボタン
- **アーカイブモーダル**: アーカイブ前にプロジェクトの詳細とタスク統計を表示
- **アーカイブタブ**: アーカイブされたリストを表示するページ分割テーブル付きナビゲーションの新タブ
- **アーカイブストレージ**: 完全なプロジェクトメタデータを含む履歴と同様のJSONフォーマットストレージ

##### **高度なテーブルインターフェース**
- **TanStack React Table**: ソート、ページネーション、フィルタリング付きプロフェッショナルテーブル
- **テーブル列**: ID（短縮）、タイムスタンプ、初期リクエスト（切り詰め）、統計、アクション
- **アクション**: 確認ダイアログ付きの表示（👁️）、削除（🗑️）、インポート（📥）
- **ページネーション**: 完全なナビゲーションコントロール付き1ページ15項目

##### **インポートとエクスポートオプション**
- **インポートモーダル**: 現在のタスクに追加するかすべてのタスクを置換するかを選択
- **警告システム**: 破壊的操作に対する明確な赤い警告
- **表示モーダル**: 既存のTaskTableを使用したフルスクリーン読み取り専用タスクビューアー
- **データ整合性**: 初期リクエストを含む完全なプロジェクトコンテキスト保持

#### 🔧 技術的な実装

##### **アーカイブコンポーネント**
- **ArchiveModal**: プロジェクト統計表示付き確認ダイアログ
- **ArchiveView**: 包括的なTanStackテーブル実装のメインテーブルビュー
- **ImportArchiveModal**: 追加/置換機能付きインポートオプション
- **ViewArchiveModal**: 完全なTaskTable統合付き読み取り専用タスクビューアー

##### **データ構造**
```javascript
{
  id: uuid,
  timestamp: ISO文字列,
  projectId: 文字列,
  projectName: 文字列,
  initialRequest: 文字列,
  tasks: Task[],
  stats: { completed: 数値, inProgress: 数値, pending: 数値 },
  finalSummary: 文字列
}
```

##### **テスト駆動開発**
- **100+テスト**: TDD方法論を使用した包括的テストカバレッジ
- **すべてのコンポーネント**: すべてのアーカイブコンポーネントが完全なテストスイートを持つ
- **エッジケース**: 空データ、不正なアーカイブ、ストレージ障害の処理
- **UIインタラクション**: React Testing Libraryによる完全なユーザーワークフローテスト

🌍 国際化
3言語にわたる完全なi18nサポート：
- 🇬🇧 英語: Archive, Archive Tasks, Import Archive等
- 🇨🇳 中国語: 存档, 存档任务, 导入存档等
- 🇯🇵 日本語: アーカイブ, タスクをアーカイブ, アーカイブをインポート等

#### 💻 使用方法

1. **タスクアーカイブ**: 📦アーカイブボタンをクリック、プロジェクト詳細付きモーダルで確認
2. **アーカイブ表示**: アーカイブタブに移動してアーカイブされたタスクリストのページ分割リストを表示  
3. **アーカイブインポート**: 📥インポートをクリック、現在のタスクに追加または置換を選択
4. **アーカイブ表示**: 👁️表示をクリックして完全な読み取り専用タスクリストを表示
5. **アーカイブ削除**: 確認ダイアログ付きの🗑️削除をクリック

🚀 利益

1. **プロジェクト継続性**
   - すべてのコンテキストを含む完全なプロジェクトスナップショットの保存
   - 必要時に以前のプロジェクト状態を復元  
   - プロジェクト進化の履歴維持

2. **柔軟なワークフロー**
   - 将来の参考のために完了プロジェクトをアーカイブ
   - インポートを使用した異なるタスクアプローチでの実験
   - 作業履歴を保持しながらワークスペースをクリーンアップ

3. **プロフェッショナルな実装**  
   - セッション間での堅牢なlocalStorage永続化
   - メタデータ保持を含む完全なデータ整合性
   - 既存のデザインシステムにマッチするプロフェッショナルUI

---

## 🐛 バグ修正と改善

### 一般的なバグ修正
- サーバーレスポンスでのタスクファイルフォーマット処理を修正
- 不正なJSONファイルのエラーハンドリングを改善
- より良いパフォーマンスのためのキャッシュ管理を強化
- ENOENTエラーを防ぐためのデータパス用ディレクトリ作成を追加
- **エージェントコマンドコピーを修正**: ロボット絵文字（🤖）が現在のディレクトリに関係なく正しく動作するよう、エージェントコマンドをコピーする際に完全なプロジェクトパスを含むようになりました
  - グローバルエージェント: 完全なClaudeフォルダパスを含む（例：`/home/user/claude/agents/fullstack.md`）
  - プロジェクトエージェント: 完全なプロジェクトルートパスを含む（例：`/home/user/project/.claude/agents/fullstack.md`）
- **ロボット絵文字ボタンの強化**: より良い視認性と区別のために色付き境界線（黄色と緑）を追加
- **エージェント情報モーダル説明**: ハードコーディングされたエージェント説明が常に使用されることを保証して空白説明問題を修正
  - test-expert、react-optimizer、ui-developer、architectエージェントの包括的説明を追加
  - 適切なフォーマットを含む未知エージェントの強化されたフォールバック説明
- **本番タスクJSON**: 本番タスクファイルで500エラーを引き起こしていた不正なJSONを修正

### 強化カテゴリ

##### **最終要約の強化**
- **未完成タスク警告**: 未完成タスクに対する赤い警告セクションを追加（⚠️ 残りのタスク）
- **進捗精度**: 誤った完了主張の代わりに「Y個のタスクのうちX個完了（Z%進捗）」を表示  
- **強化されたスタイリング**: 未完成タスクインジケーター用の赤い警告色（#e74c3c）
- **インテリジェント分析**: 完了タスクと保留タスク間の適切な区別

##### **エージェント検出修正**
- **パス解決**: 適切なエージェント検出のためのプロジェクトルートパスマッピングを修正
- **エラーメッセージ**: ピリオド後の適切なスペースを含むエラーメッセージフォーマットを改善
- **テストカバレッジ**: 8+のテストシナリオを含む包括的なエージェント検出テストを追加
- **.claude/agentsディレクトリ構造の強化された検証**

##### **API強化**
- **新しいエンドポイント**: インテリジェントな要約生成のための`/api/tasks/{projectId}/summarize`を追加
- **未完成タスク**: サーバーが要約で残りタスクを処理・強調表示
- **エラーハンドリング**: サーバーサイドのエラーハンドリングと検証を改善
- **テストインフラストラクチャー**: モックシナリオを含む包括的なAPIエンドポイントテストを追加

---

**完全な変更ログ**: v3.0.0...v3.1.0

*リリース日: 2025年9月1日*