# 🚀 Task Viewer v2.1.0 发行说明

*发布日期：2025年7月29日*

## 🎉 新功能

### 🔗 支持项目根目录的可点击文件路径
**一键复制完整文件路径！**

- **点击复制文件路径**：现在当您点击任务并进入任务详情页面时，如果有任何相关文件列表显示任务修改或创建的文件，该文件名现在将有一个指向文件系统中实际文件的超链接（前提是您在创建/编辑配置文件标签时配置了项目文件夹）

### 📋 增强的 UUID 管理
**通过直观交互简化UUID复制**

在与 Claude 交互时，有时轻松引用虾任务很有用，例如：
"Claude，请完成这个虾任务：da987923-2afe-4ac3-985e-ac029cc831e7"。因此，我们在任务 # 徽章和任务名称列中列出的 UUID 上添加了点击复制功能。

- **点击复制任务徽章**：点击任何任务编号徽章即可立即复制其 UUID
- **任务名称列下显示的连接 UUID**：点击 UUID 进行复制

### 🔄 便于并行化的任务依赖列

我们添加了一个依赖列，列出任何依赖任务的链接 UUID。现在您可以轻松导航到依赖任务。

### 🤖 AI 指令操作
**一键 AI 任务指令**

我们添加了一个操作列，有一个方便的机器人表情符号。如果您点击表情符号，它将复制一个 AI 指令到剪贴板，然后您可以将其粘贴到您的代理聊天中。该指令已编码为复制以下内容："使用任务管理器完成这个虾任务：< UUID >"

此指令对于并行化很有用。例如，如果以下 3 个任务没有依赖关系，您可以打开几个终端窗口，并粘贴 AI 指令。示例：

终端 1：使用任务管理器完成这个虾任务：da987923-2afe-4ac3-985e-ac029cc831e7
终端 2：使用任务管理器完成这个虾任务：4afe3f1c-bf7f-4642-8485-668c33a1e0fc
终端 3：使用任务管理器完成这个虾任务：21bd2cb9-4109-4897-9904-885ee2b0792e

### ✏️ 配置文件编辑按钮

**项目根配置**：现在您可以为每个配置文件设置项目根，这将允许您在查看任务详情页面时启用"相关文件"的完整文件路径复制。

**重命名配置文件的能力**：现在您可以重命名配置文件标签，而无需删除和重新创建。



## 🔄 变更

### UI/UX 改进
- **简化复制操作**：将 UUID 复制整合为仅点击任务徽章
- **依赖优于备注**：用更有用的依赖列替换备注列
- **应用内发行说明**：任务查看器的发行说明显示在顶部横幅中
- **基于标签的导航**：发行说明集成到标签系统中，带有关闭功能

### 架构更新
- **ES 模块兼容性**：移除 busboy 依赖以获得更好的 ES 模块支持
- **原生表单解析**：用 Node.js 内置功能替换第三方表单解析
- **版本升级**：更新到 v2.1.0（任务查看器）以反映重大功能添加

## 🐛 错误修复

### 🚨 关键修复：文件上传创建静态副本
**问题**：通过上传 tasks.json 文件添加配置文件时，系统在 `/tmp/` 目录中创建了静态副本。这意味着对实际任务文件的任何更改都不会在查看器中反映出来 - 任务看起来会停留在原始状态（例如，实际"已完成"时显示"进行中"）。

**解决方案**：完全移除文件上传。现在您必须直接输入文件夹路径，系统会自动附加 `/tasks.json`。这确保查看器始终从您的实际实时文件中读取。

**使用方法**：
1. 在终端中导航到您的虾数据文件夹
2. 输入 `pwd` 获取完整路径（在 UI 中以黄色突出显示）
3. 将此路径粘贴到"任务文件夹路径"字段中
4. 系统自动使用 `[您的路径]/tasks.json`

![添加配置文件模态截图](/releases/add-profile-modal.png)

### 配置文件管理
- **自动选择修复**：新配置文件现在在创建后自动选择和加载
- **导入问题解决**：修复了 busboy 库的 ES 模块导入问题
- **统一编辑模态**：将重命名和项目根编辑合并到单一界面中

### 数据处理
- **项目根持久化**：项目根路径现在与配置文件数据正确保存
- **任务加载**：修复了在配置文件间切换时的竞态条件
- **状态管理**：改进了配置文件选择状态的处理

## 🗑️ 移除

### 已弃用功能
- **Busboy 依赖**：替换为原生 Node.js 表单解析
- **备注列**：替换为更有用的依赖列
- **单独复制按钮**：UUID 复制整合为点击任务徽章
- **单独重命名按钮**：合并到统一的编辑配置文件按钮中

## 📝 技术细节

### 新的 API 端点
- **PUT /api/update-profile/:id**：更新配置文件名称和设置
- **增强的 /api/tasks/:id**：现在在响应中包含 projectRoot
- **GET /releases/*.md**：提供发行说明 markdown 文件

### 前端组件
- **ReleaseNotes 组件**：漂亮的 markdown 渲染发行说明
- **增强的 TaskTable**：支持依赖和操作列
- **改进的 TaskDetailView**：可点击文件路径，带有完整路径复制

### 配置
- **项目根存储**：配置文件现在存储可选的 projectRoot 路径
- **设置持久化**：所有配置文件数据保存到 ~/.shrimp-task-viewer-settings.json

## 🎯 总结

版本 2.1.0 将任务查看器转变为更集成的开发工具，具有增强的文件路径管理、改进的 UUID 处理和更好的任务关系可视化。统一的配置文件管理和应用内发行说明提供了更连贯的用户体验，同时保持清洁、直观的界面。